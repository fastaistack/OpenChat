import{r as i,a5 as P,u as ee,g as te,A as ae,c as K,a as c,d as s,b as t,h as le,s as ie,t as f,j as r,i as V,V as se,F as ne,e as n,Z as B,D as oe,o as y,H as re,x as I,m as N,l as L}from"./index-DeTX4u6w.js";import{a as de,b as ue,g as $,f as ce}from"./FileIcon-CU0bddBL.js";import{U as fe}from"./UploadFile-CouzNMC_.js";import{_ as me}from"./FileViewer-HgYaZZsl.js";import{h as pe,i as be,j as ge}from"./knowledge-DUyd3uXj.js";import{_ as ve}from"./_plugin-vue_export-helper-DYCmnC6K.js";import"./dropdown.esm-BDqkxJ5p.js";import"./inputnumber.esm-C99a3dX7.js";import"./index.esm-Cx_30BBj.js";import"./fileupload.esm-DUOczVAM.js";const ke={class:"w-full m-5 h-full overflow-y-auto flex flex-col items-start justify-start overflow-x-hidden"},ye={class:"flex justify-between items-center my-5 w-full"},he={class:"font-bold text-xl"},we={class:"flex items-center"},_e=["src"],Fe={class:"file-title"},$e={__name:"KnowledgeDetail",setup(Ce){const H=i(["pdf","docx","txt","html","htm","md","json","jsonl","xml"]),C=P(),U=ee(),q=le(),x=te(),T=i([]),m=i(0),h=x.query.id,E=x.query.name;function M(e,a){U.require({target:e.currentTarget,message:n("kb.deleteConfirmMsg"),icon:"pi pi-info-circle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:n("lang.cancel"),acceptLabel:n("kb.delete"),accept:()=>{ge(a.id).then(()=>{C.add({severity:"success",summary:n("kb.success"),detail:n("kb.deleteSuccess"),life:3e3}),j()})}})}const o=i(!1),w=i(""),_=i(!1),p=i(!1);function D(){o.value=!1,R()}function R(){b.value="",_.value=!1,p.value=!1}function A(){D(),j()}function O(){o.value=!0,w.value=n("kb.importFile"),B(()=>{_.value=!0})}const z=i(""),b=i(""),S=i("");function Z(e){S.value=e.id,z.value=e.name,b.value=$(z.value),o.value=!0,w.value=e.name,B(()=>{p.value=!0})}let d={page:1,pageSize:10};function g(){h&&pe({id:h,page:d.page,pagesize:d.pageSize}).then(e=>{const a=e.resData;T.value=a.data,m.value=a.total,setTimeout(()=>{g()},5e3)})}const v=i(0);function j(){d.page=1,v.value=0,g()}function G(e){d.page=e.page+1,d.pageSize=e.rows,g()}function J(e){const a=$(e);return ce(a)}function Q(e){be({id:e}).then(a=>{a.resCode===0&&C.add({severity:"success",summary:n("kb.success"),detail:n("kb.analysisSuccess"),life:3e3})})}return ae(()=>{g()}),(e,a)=>{const u=ie,k=ue,W=de,X=se,Y=oe("tooltip");return y(),K(ne,null,[c("div",ke,[c("div",ye,[s(u,{text:"",icon:"pi pi-angle-left",label:e.$t("kb.returnKb"),onClick:a[0]||(a[0]=l=>t(q).replace("/knowledge"))},null,8,["label"]),c("span",he,f(t(E)),1),s(u,{icon:"pi pi-upload",label:e.$t("kb.importFile"),onClick:O},null,8,["label"])]),s(W,{lazy:"",value:t(T),paginator:t(m)>0,first:t(v),"onUpdate:first":a[1]||(a[1]=l=>V(v)?v.value=l:null),rows:10,rowsPerPageOptions:[10,20,30],totalRecords:t(m),stripedRows:"",rowHover:"",resizableColumns:"",dataKey:"id",tableStyle:"min-width: 50rem",onPage:G,pt:{root:{style:{width:"100%"}}}},{paginatorstart:r(()=>a[3]||(a[3]=[])),paginatorend:r(()=>[I(f(e.$t("kb.total"))+" "+f(t(m))+" "+f(e.$t("kb.items")),1)]),default:r(()=>[s(k,{field:"name",header:e.$t("kb.name")},{body:r(({data:l})=>[c("div",we,[c("img",{src:J(l.name),alt:"",style:{width:"25px","margin-right":"5px"}},null,8,_e),re((y(),K("div",Fe,[I(f(l.name),1)])),[[Y,l.name]])])]),_:1},8,["header"]),s(k,{field:"size",header:e.$t("kb.fileSize")},null,8,["header"]),s(k,{field:"createtime",header:e.$t("kb.uploadTime")},null,8,["header"]),s(k,{field:"operation",header:e.$t("kb.operation")},{body:r(l=>[s(u,{label:l.data.status===1?"解析中":l.data.status===2?"解析完成":e.$t("kb.analysis"),disabled:[1,2].includes(l.data.status),text:"",onClick:F=>Q(l.data.id)},null,8,["label","disabled","onClick"]),s(u,{label:e.$t("kb.viewFile"),text:"",disabled:!t(H).includes(t($)(l.data.name)),onClick:F=>Z(l.data)},null,8,["label","disabled","onClick"]),s(u,{label:e.$t("kb.delete"),text:"",severity:"danger",onClick:F=>M(F,l.data)},null,8,["label","onClick"])]),_:1},8,["header"])]),_:1},8,["value","paginator","first","totalRecords"])]),s(X,{visible:t(o),"onUpdate:visible":a[2]||(a[2]=l=>V(o)?o.value=l:null),modal:"",maximizable:t(p),header:t(w),class:"w-[50%] min-w-96","content-style":t(b)==="pdf"?"height:100vh;":"min-height:200px",onHide:R},{default:r(()=>[t(p)?(y(),N(me,{key:0,ref:"fileViewerRef",fileId:t(S),fileType:t(b)},null,8,["fileId","fileType"])):L("",!0),t(_)?(y(),N(fe,{key:1,ref:"uploadFileRef",id:t(h),showButton:!0,onHide:D,onSuccess:A},null,8,["id"])):L("",!0)]),_:1},8,["visible","maximizable","header","content-style"])],64)}}},Ie=ve($e,[["__scopeId","data-v-4944847d"]]);export{Ie as default};
