import{r as i,a5 as Y,u as ee,g as te,A as ae,c as K,a as u,d as s,b as t,h as le,s as ie,t as f,j as r,i as V,V as se,F as oe,e as o,Z as B,D as ne,o as k,H as re,x as I,m as N,l as L}from"./index-DFcxYj_y.js";import{a as de,b as ce,g as $,f as ue}from"./FileIcon-CFcRhR8H.js";import{U as fe}from"./UploadFile-cGcommZm.js";import{_ as pe}from"./FileViewer-COeBupib.js";import{i as me,j as be,k as ge}from"./knowledge-BUDwfYIP.js";import{_ as ve}from"./_plugin-vue_export-helper-SEVEPmIB.js";import"./dropdown.esm-9GoScJx2.js";import"./index.esm-RqRS3dAP.js";import"./fileupload.esm-jJFadivN.js";const ke={class:"w-full m-5 h-full overflow-y-auto flex flex-col items-start justify-start overflow-x-hidden"},ye={class:"flex justify-between items-center my-5 w-full"},he={class:"font-bold text-xl"},we={class:"flex items-center"},_e=["src"],Fe={class:"file-title"},$e={__name:"KnowledgeDetail",setup(Ce){const H=i(["pdf","docx","txt","html","htm","md","json","jsonl","xml"]),C=Y(),U=ee(),q=le(),x=te(),D=i([]),p=i(0),y=x.query.id,E=x.query.name;function M(e,a){U.require({target:e.currentTarget,message:o("kb.deleteConfirmMsg"),icon:"pi pi-info-circle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:o("lang.cancel"),acceptLabel:o("kb.delete"),accept:()=>{ge(a.id).then(()=>{C.add({severity:"success",summary:o("kb.success"),detail:o("kb.deleteSuccess"),life:3e3}),j()})}})}const n=i(!1),h=i(""),w=i(!1),m=i(!1);function T(){n.value=!1,R()}function R(){b.value="",w.value=!1,m.value=!1}function P(){T(),j()}function A(){n.value=!0,h.value=o("kb.importFile"),B(()=>{w.value=!0})}const z=i(""),b=i(""),S=i("");function O(e){S.value=e.id,z.value=e.name,b.value=$(z.value),n.value=!0,h.value=e.name,B(()=>{m.value=!0})}let d={page:1,pageSize:10};function _(){y&&me({id:y,page:d.page,pagesize:d.pageSize}).then(e=>{const a=e.resData;D.value=a.data,p.value=a.total})}const g=i(0);function j(){d.page=1,g.value=0,_()}function Z(e){d.page=e.page+1,d.pageSize=e.rows,_()}function G(e){const a=$(e);return ue(a)}function J(e){be({id:e}).then(a=>{a.resCode===0&&C.add({severity:"success",summary:o("kb.success"),detail:o("kb.analysisSuccess"),life:3e3})})}return ae(()=>{_()}),(e,a)=>{const c=ie,v=ce,Q=de,W=se,X=ne("tooltip");return k(),K(oe,null,[u("div",ke,[u("div",ye,[s(c,{text:"",icon:"pi pi-angle-left",label:e.$t("kb.returnKb"),onClick:a[0]||(a[0]=l=>t(q).replace("/knowledge"))},null,8,["label"]),u("span",he,f(t(E)),1),s(c,{icon:"pi pi-upload",label:e.$t("kb.importFile"),onClick:A},null,8,["label"])]),s(Q,{lazy:"",value:t(D),paginator:t(p)>0,first:t(g),"onUpdate:first":a[1]||(a[1]=l=>V(g)?g.value=l:null),rows:10,rowsPerPageOptions:[10,20,30],totalRecords:t(p),stripedRows:"",rowHover:"",resizableColumns:"",dataKey:"id",tableStyle:"min-width: 50rem",onPage:Z,pt:{root:{style:{width:"100%"}}}},{paginatorstart:r(()=>a[3]||(a[3]=[])),paginatorend:r(()=>[I(f(e.$t("kb.total"))+" "+f(t(p))+" "+f(e.$t("kb.items")),1)]),default:r(()=>[s(v,{field:"name",header:e.$t("kb.name")},{body:r(({data:l})=>[u("div",we,[u("img",{src:G(l.name),alt:"",style:{width:"25px","margin-right":"5px"}},null,8,_e),re((k(),K("div",Fe,[I(f(l.name),1)])),[[X,l.name]])])]),_:1},8,["header"]),s(v,{field:"size",header:e.$t("kb.fileSize")},null,8,["header"]),s(v,{field:"createtime",header:e.$t("kb.uploadTime")},null,8,["header"]),s(v,{field:"operation",header:e.$t("kb.operation")},{body:r(l=>[s(c,{label:e.$t("kb.analysis"),text:"",onClick:F=>J(l.data.id)},null,8,["label","onClick"]),s(c,{label:e.$t("kb.viewFile"),text:"",disabled:!t(H).includes(t($)(l.data.name)),onClick:F=>O(l.data)},null,8,["label","disabled","onClick"]),s(c,{label:e.$t("kb.delete"),text:"",severity:"danger",onClick:F=>M(F,l.data)},null,8,["label","onClick"])]),_:1},8,["header"])]),_:1},8,["value","paginator","first","totalRecords"])]),s(W,{visible:t(n),"onUpdate:visible":a[2]||(a[2]=l=>V(n)?n.value=l:null),modal:"",maximizable:t(m),header:t(h),class:"w-[50%] min-w-96","content-style":t(b)==="pdf"?"height:100vh;":"min-height:200px",onHide:R},{default:r(()=>[t(m)?(k(),N(pe,{key:0,ref:"fileViewerRef",fileId:t(S),fileType:t(b)},null,8,["fileId","fileType"])):L("",!0),t(w)?(k(),N(fe,{key:1,ref:"uploadFileRef",id:t(y),showButton:!0,onHide:T,onSuccess:P},null,8,["id"])):L("",!0)]),_:1},8,["visible","maximizable","header","content-style"])],64)}}},Be=ve($e,[["__scopeId","data-v-38bba25a"]]);export{Be as default};
