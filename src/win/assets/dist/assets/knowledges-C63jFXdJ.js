import{a5 as B,r as n,A as L,a6 as R,c as u,o as r,a as t,d as v,l as b,m as T,b as s,i as x,s as N,t as l,j as U,V as H,e as y}from"./index-C4IDSyN5.js";import{s as M}from"./dropdown.esm-BbE1jaVP.js";import{_ as O}from"./DocChatConfig-Cb_bq61R.js";import{e as P,h as z,m as A}from"./knowledge-JFy0f9oy.js";import{u as E}from"./Chat-DaK6BaqH.js";import{u as W}from"./dayjs.min-1nbVSqdk.js";import{_ as q}from"./_plugin-vue_export-helper-D899kGel.js";import"./slider.esm-D2C1pmBb.js";import"./Markdown-CW5nZ-ZV.js";import"./card.esm-Ci5w_Chg.js";import"./avatar.esm-E34m7gMy.js";import"./FileViewer-Dk77B4-v.js";const F={class:"knowledge"},G={class:"kb_config w-full tabs-item"},J={class:"flex justify-between items-center"},Q={key:0,class:"px-5 space-y-4 mt-4"},X={class:"flex flex-col items-start justify-between"},Y={class:"label shrink-0 w-48 text-slate-500 font-bold text-sm mb-2"},Z={class:"value text-slate-400 break-all"},ee={class:"flex flex-col items-start justify-between"},te={class:"label shrink-0 w-48 text-slate-500 font-bold text-sm mb-2"},se={class:"value text-slate-400 break-all"},ae={key:0,class:"flex flex-col items-start justify-between"},le={class:"label shrink-0 w-48 text-slate-500 font-bold text-sm mb-2"},oe={class:"value text-slate-400 break-all"},ne={key:1,class:"flex flex-col items-start justify-between"},ie={class:"label shrink-0 w-48 text-slate-500 font-bold text-sm mb-2"},re={class:"value text-slate-400 break-all"},de={key:2,class:"flex flex-col items-start justify-between"},ce={class:"label shrink-0 w-48 text-slate-500 font-bold text-sm mb-2"},ue={class:"value text-slate-400 break-all"},be={class:"flex flex-col items-start justify-between"},me={class:"label shrink-0 w-48 text-slate-500 font-bold text-sm mb-2"},fe={class:"value text-slate-400 break-all"},_e={__name:"knowledges",setup(ve){const w=B(),p=E(),h=n(W().currentConversationId),i=n(!1),K=n();function S(){i.value=!0}const f=n([]);function k(){z({name:"",page:1,pagesize:999999}).then(e=>{const a=e.resData;f.value=a.data})}const d=n(""),m=n({}),o=n({});async function $({value:e}){const a=f.value.find(_=>_.id===e);m.value=Object.assign({},a),p.setKbdata(m.value),await C()}function C(){return A({kbId:m.value.id,sessionId:h.value,plugin_key:"retrievers"}).then(e=>{o.value=e.resData})}function D(e){i.value=!1,o.value=Object.assign({},e),k()}const g=n(!1);function j(){P("chromadb").then(e=>{e.resData.embed_model?(g.value=!0,k()):(g.value=!1,w.add({severity:"warn",summary:y("kb.warn"),detail:y("kb.dbConfigWarn"),life:3e3}))})}return L(()=>{j()}),R(()=>{p.clearPluginData()}),(e,a)=>{const _=M,I=N,V=H;return r(),u("div",F,[t("div",G,[t("div",J,[v(_,{modelValue:s(d),"onUpdate:modelValue":a[0]||(a[0]=c=>x(d)?d.value=c:null),options:s(f),optionLabel:"name",optionValue:"id",placeholder:e.$t("kb.selectKb"),checkmark:"",class:"w-3/5",onChange:$},null,8,["modelValue","options","placeholder"]),s(d)?(r(),T(I,{key:0,text:"",onClick:S,label:e.$t("lang.config")},null,8,["label"])):b("",!0)]),s(d)?(r(),u("div",Q,[t("div",X,[t("div",Y,l(e.$t("kb.textCount")),1),t("div",Z,l(s(o).k),1)]),t("div",ee,[t("div",te,l(e.$t("kb.searchType")),1),t("div",se,l(s(o).search_type),1)]),s(o).search_type==="similarity_score_threshold"?(r(),u("div",ae,[t("div",le,l(e.$t("kb.scoreThreshold")),1),t("div",oe,l(s(o).score_threshold),1)])):b("",!0),s(o).search_type==="mmr"?(r(),u("div",ne,[t("div",ie,l(e.$t("kb.fetchK")),1),t("div",re,l(s(o).fetch_k),1)])):b("",!0),s(o).search_type==="mmr"?(r(),u("div",de,[t("div",ce,l(e.$t("kb.lambdaMult")),1),t("div",ue,l(s(o).lambda_mult),1)])):b("",!0),t("div",be,[t("div",me,l(e.$t("kb.propmtTemplate")),1),t("div",fe,l(s(o).prompt_template),1)])])):b("",!0)]),v(V,{visible:s(i),"onUpdate:visible":a[2]||(a[2]=c=>x(i)?i.value=c:null),modal:"",header:e.$t("kb.kbSetting"),style:{width:"600px"},onHide:a[3]||(a[3]=c=>i.value=!1)},{default:U(()=>[v(O,{ref_key:"editKbSettingRef",ref:K,sessionId:s(h),kbId:s(m).id,type:"retrievers",onSuccess:D,onHide:a[1]||(a[1]=c=>i.value=!1)},null,8,["sessionId","kbId"])]),_:1},8,["visible","header"])])}}},je=q(_e,[["__scopeId","data-v-47153391"]]);export{je as default};
