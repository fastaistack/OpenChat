import{r as s,a5 as ee,u as te,g as ae,A as le,c as x,a as d,d as i,b as a,h as se,s as ie,t as u,j as c,i as z,V as ne,F as oe,e as o,Z as A,D as re,o as h,H as de,x as j,n as ue,m as B,l as K}from"./index-eE6Y338R.js";import{a as ce,b as fe,g as T,f as me}from"./FileIcon-xwz9m_g3.js";import{U as pe}from"./UploadFile-DYplUIAI.js";import{_ as be}from"./FileViewer-D4lgJL7i.js";import{h as ge,i as ve,j as ke}from"./knowledge-IEvuAe_Z.js";import{_ as ye}from"./_plugin-vue_export-helper-Dj9PH-fG.js";import"./dropdown.esm-D4kKLJT5.js";import"./inputnumber.esm-0RUmE-GB.js";import"./index.esm-CetvORWH.js";import"./fileupload.esm-BmoF79YT.js";const he={class:"w-full m-5 h-full overflow-y-auto flex flex-col items-start justify-start overflow-x-hidden"},we={class:"flex justify-between items-center my-5 w-full"},Ce={class:"font-bold text-xl"},Fe={class:"flex items-center"},$e=["src"],Te={class:"file-title"},De={__name:"KnowledgeDetail",setup(_e){const O=s(["pdf","docx","txt","html","htm","md","json","jsonl","xml"]),D=ee(),V=te(),M=se(),_=ae(),R=s([]),p=s(0),n={PARSING:1,COMPLETED:2,FAILED:-1,TOBEANA:0},w=_.query.id,G=_.query.name;function U(e,l){V.require({target:e.currentTarget,message:o("kb.deleteConfirmMsg"),icon:"pi pi-info-circle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:o("lang.cancel"),acceptLabel:o("kb.delete"),accept:()=>{ke(l.id).then(()=>{D.add({severity:"success",summary:o("kb.success"),detail:o("kb.deleteSuccess"),life:3e3}),N()})}})}const r=s(!1),C=s(""),F=s(!1),b=s(!1);function I(){r.value=!1,S()}function S(){g.value="",F.value=!1,b.value=!1}function H(){I(),N()}function q(){r.value=!0,C.value=o("kb.importFile"),A(()=>{F.value=!0})}const E=s(""),g=s(""),L=s("");function P(e){L.value=e.id,E.value=e.name,g.value=T(E.value),r.value=!0,C.value=e.name,A(()=>{b.value=!0})}let f={page:1,pageSize:10};function v(){w&&ge({id:w,page:f.page,pagesize:f.pageSize}).then(e=>{const l=e.resData;R.value=l.data,p.value=l.total,setTimeout(()=>{v()},500)})}const k=s(0);function N(){f.page=1,k.value=0,v()}function Z(e){f.page=e.page+1,f.pageSize=e.rows,v()}function J(e){const l=T(e);return me(l)}function Q(e){ve({id:e}).then(l=>{l.resCode===0&&D.add({severity:"success",summary:o("kb.success"),detail:o("kb.analysisSuccess"),life:3e3})})}return le(()=>{v()}),(e,l)=>{const m=ie,y=fe,W=ce,X=ne,Y=re("tooltip");return h(),x(oe,null,[d("div",he,[d("div",we,[i(m,{text:"",icon:"pi pi-angle-left",label:e.$t("kb.returnKb"),onClick:l[0]||(l[0]=t=>a(M).replace("/knowledge"))},null,8,["label"]),d("span",Ce,u(a(G)),1),i(m,{icon:"pi pi-upload",label:e.$t("kb.importFile"),onClick:q},null,8,["label"])]),i(W,{lazy:"",value:a(R),paginator:a(p)>0,first:a(k),"onUpdate:first":l[1]||(l[1]=t=>z(k)?k.value=t:null),rows:10,rowsPerPageOptions:[10,20,30],totalRecords:a(p),stripedRows:"",rowHover:"",resizableColumns:"",dataKey:"id",tableStyle:"min-width: 50rem",onPage:Z,pt:{root:{style:{width:"100%"}}}},{paginatorstart:c(()=>l[3]||(l[3]=[])),paginatorend:c(()=>[j(u(e.$t("kb.total"))+" "+u(a(p))+" "+u(e.$t("kb.items")),1)]),default:c(()=>[i(y,{field:"name",header:e.$t("kb.name")},{body:c(({data:t})=>[d("div",Fe,[d("img",{src:J(t.name),alt:"",style:{width:"25px","margin-right":"5px"}},null,8,$e),de((h(),x("div",Te,[j(u(t.name),1)])),[[Y,t.name]])])]),_:1},8,["header"]),i(y,{field:"size",header:e.$t("kb.fileSize")},null,8,["header"]),i(y,{field:"createtime",header:e.$t("kb.uploadTime")},null,8,["header"]),i(y,{field:"operation",header:e.$t("kb.operation")},{body:c(t=>[i(m,{label:e.$t("kb.analysis"),disabled:[n.PARSING,n.COMPLETED].includes(t.data.status),text:"",onClick:$=>Q(t.data.id)},null,8,["label","disabled","onClick"]),d("span",{class:ue(["status-label",{"status-failed":t.data.status===n.FAILED,"status-parsing":t.data.status===n.PARSING,"status-completed":t.data.status===n.COMPLETED,"status-default":t.data.status===n.ORIGIN}])},u(t.data.status===n.FAILED?e.$t("kb.failedanalyse"):t.data.status===n.PARSING?e.$t("kb.parsing"):t.data.status===n.COMPLETED?e.$t("kb.completed"):e.$t("kb.originanalyse")),3),i(m,{label:e.$t("kb.viewFile"),text:"",disabled:!a(O).includes(a(T)(t.data.name)),onClick:$=>P(t.data)},null,8,["label","disabled","onClick"]),i(m,{label:e.$t("kb.delete"),text:"",severity:"danger",onClick:$=>U($,t.data)},null,8,["label","onClick"])]),_:1},8,["header"])]),_:1},8,["value","paginator","first","totalRecords"])]),i(X,{visible:a(r),"onUpdate:visible":l[2]||(l[2]=t=>z(r)?r.value=t:null),modal:"",maximizable:a(b),header:a(C),class:"w-[50%] min-w-96","content-style":a(g)==="pdf"?"height:100vh;":"min-height:200px",onHide:S},{default:c(()=>[a(b)?(h(),B(be,{key:0,ref:"fileViewerRef",fileId:a(L),fileType:a(g)},null,8,["fileId","fileType"])):K("",!0),a(F)?(h(),B(pe,{key:1,ref:"uploadFileRef",id:a(w),showButton:!0,onHide:I,onSuccess:H},null,8,["id"])):K("",!0)]),_:1},8,["visible","maximizable","header","content-style"])],64)}}},Be=ye(De,[["__scopeId","data-v-4e311f5d"]]);export{Be as default};
