import{a5 as C,P as h,r as T,A as j,c as u,o as c,a as o,l as _,t as i,d as a,b as s,s as D,F as N,e as y}from"./index-eE6Y338R.js";import{a as B,b as G}from"./slider.esm-Dg66TFIy.js";import{s as F}from"./dropdown.esm-D4kKLJT5.js";import{a as K}from"./inputnumber.esm-0RUmE-GB.js";import{m as P,o as M}from"./knowledge-IEvuAe_Z.js";const A={class:"mb-1"},E={class:"text-slate-500 font-bold text-sm"},J={class:"flex justify-start items-center space-x-2"},L={class:"mb-1"},O={class:"text-slate-500 font-bold text-sm"},R={key:0,class:"mb-1"},q={class:"text-slate-500 font-bold text-sm"},z={class:"flex justify-start items-center space-x-2"},H={key:1,class:"mb-1"},Q={class:"text-slate-500 font-bold text-sm"},W={class:"flex justify-start items-center space-x-2"},X={key:2,class:"mb-1"},Y={class:"text-slate-500 font-bold text-sm"},Z={class:"flex justify-start items-center space-x-2"},ee={class:"mb-1"},te={class:"text-slate-500 font-bold text-sm"},se={class:"flex items-center justify-end space-x-4 mt-4"},ie={__name:"DocChatConfig",props:{type:{type:String,default:""},kbId:{type:String,default:""},sessionId:{type:String,default:""}},emits:["hide","success"],setup(k,{emit:V}){const g=C(),m=k,e=h({search_type:"similarity",k:4,score_threshold:.5,fetch_k:20,lambda_mult:.5,prompt_template:""}),x=h([{label:"similarity",value:"similarity"},{label:"similarity_score_threshold",value:"similarity_score_threshold"},{label:"mmr",value:"mmr"}]),p=T(!1),f=V;function v(){f("hide")}function $(){S().then(()=>{g.add({severity:"success",summary:y("kb.success"),detail:y("kb.editSuccess"),life:3e3}),f("success",e)})}function I(){p.value=!0,P({kbId:m.kbId,sessionId:m.sessionId,plugin_key:m.type}).then(n=>{const t=n.resData;e.search_type=t.search_type,e.k=t.k,e.score_threshold=t.score_threshold,e.fetch_k=t.fetch_k,e.lambda_mult=t.lambda_mult,e.prompt_template=t.prompt_template}).finally(()=>{p.value=!1})}function S(){return M({kbId:m.kbId,sessionId:m.sessionId},{plugin_key:m.type,description:"",knowledge_setting:JSON.stringify(e)})}return j(()=>{I()}),(n,t)=>{const d=B,r=K,U=F,w=G,b=D;return c(),u(N,null,[o("div",A,[o("label",E,i(n.$t("kb.textCount")),1),o("div",J,[a(d,{class:"w-full",modelValue:s(e).k,"onUpdate:modelValue":t[0]||(t[0]=l=>s(e).k=l),min:1,max:20},null,8,["modelValue"]),a(r,{modelValue:s(e).k,"onUpdate:modelValue":t[1]||(t[1]=l=>s(e).k=l),min:1,max:20,useGrouping:!1},null,8,["modelValue"])])]),o("div",L,[o("label",O,i(n.$t("kb.searchType")),1),a(U,{class:"w-full",modelValue:s(e).search_type,"onUpdate:modelValue":t[2]||(t[2]=l=>s(e).search_type=l),options:s(x),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"])]),s(e).search_type==="similarity_score_threshold"?(c(),u("div",R,[o("label",q,i(n.$t("kb.scoreThreshold")),1),o("div",z,[a(d,{class:"w-full",modelValue:s(e).score_threshold,"onUpdate:modelValue":t[3]||(t[3]=l=>s(e).score_threshold=l),min:0,max:1,step:.1},null,8,["modelValue"]),a(r,{modelValue:s(e).score_threshold,"onUpdate:modelValue":t[4]||(t[4]=l=>s(e).score_threshold=l),min:0,max:1,step:.1,useGrouping:!1},null,8,["modelValue"])])])):_("",!0),s(e).search_type==="mmr"?(c(),u("div",H,[o("label",Q,i(n.$t("kb.fetchK")),1),o("div",W,[a(d,{class:"w-full",modelValue:s(e).fetch_k,"onUpdate:modelValue":t[5]||(t[5]=l=>s(e).fetch_k=l),min:1,max:50},null,8,["modelValue"]),a(r,{modelValue:s(e).fetch_k,"onUpdate:modelValue":t[6]||(t[6]=l=>s(e).fetch_k=l),min:1,max:50,useGrouping:!1},null,8,["modelValue"])])])):_("",!0),s(e).search_type==="mmr"?(c(),u("div",X,[o("label",Y,i(n.$t("kb.lambdaMult")),1),o("div",Z,[a(d,{class:"w-full",modelValue:s(e).lambda_mult,"onUpdate:modelValue":t[7]||(t[7]=l=>s(e).lambda_mult=l),min:0,max:1,step:.1},null,8,["modelValue"]),a(r,{modelValue:s(e).lambda_mult,"onUpdate:modelValue":t[8]||(t[8]=l=>s(e).lambda_mult=l),min:0,max:1,step:.1,useGrouping:!1},null,8,["modelValue"])])])):_("",!0),o("div",ee,[o("label",te,i(n.$t("kb.propmtTemplate")),1),a(w,{class:"w-full",modelValue:s(e).prompt_template,"onUpdate:modelValue":t[9]||(t[9]=l=>s(e).prompt_template=l),rows:"5",cols:"30",maxlength:300},null,8,["modelValue"])]),o("div",se,[a(b,{label:n.$t("lang.cancel"),severity:"secondary",onClick:v},null,8,["label"]),a(b,{label:n.$t("lang.confirm"),onClick:$,disabled:s(p)},null,8,["label","disabled"])])],64)}}};export{ie as _};
